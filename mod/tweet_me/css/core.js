define("components/flight/lib/utils",[],function(){function c(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};d&&c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}}var a=[],b=100,d={isDomObj:function(a){return!!a.nodeType||a===window},toArray:function(b,c){return a.slice.call(b,c)},merge:function(){var a=this.toArray(arguments);return a.unshift({}),a[a.length-1]===!0&&(a.pop(),a.unshift(!0)),$.extend.apply(undefined,a)},push:function(a,b,c){return a&&Object.keys(b||{}).forEach(function(d){if(a[d]&&c)throw Error("utils.push attempted to overwrite '"+d+"' while running in protected mode");typeof a[d]=="object"&&typeof b[d]=="object"?this.push(a[d],b[d]):a[d]=b[d]},this),a},isEnumerable:function(a,b){return Object.keys(a).indexOf(b)>-1},compose:function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},uniqueArray:function(a){var b={},c=[];for(var d=0,e=a.length;d<e;++d){if(b.hasOwnProperty(a[d]))continue;c.push(a[d]),b[a[d]]=1}return c},debounce:function(a,d){return typeof d!="number"&&(d=b),c(a,d,!0)},throttle:function(a,d){return typeof d!="number"&&(d=b),c(a,d,!1)},countThen:function(a,b){return function(){if(!--a)return b.apply(this,arguments)}},delegate:function(a){return function(b,c){var d=$(b.target),e;Object.keys(a).forEach(function(f){if((e=d.closest(f)).length)return c=c||{},c.el=e[0],a[f].apply(this,[b,c])},this)}}};return d})
define("components/flight/lib/registry",["./utils"],function(a){function b(b,c){var d,e,f;return c=a.toArray(c),typeof c[c.length-1]=="function"&&(f=c.pop()),typeof c[c.length-1]=="object"&&c.pop(),c.length==2?(d=c[0],e=c[1]):(d=b.node,e=c[0]),{element:d,type:e,callback:f}}function c(a,b){return a.element==b.element&&a.type==b.type&&(b.callback==null||a.callback==b.callback)}function d(){function e(a){this.component=a,this.instances=[],this.addInstance=function(a){this.throwIfInstanceExistsOnNode(a);var b=new f(a);return this.instances.push(b),b},this.throwIfInstanceExistsOnNode=function(a){this.instances.forEach(function(b){if(b.instance.$node[0]===a.$node[0])throw new Error("Instance of "+a.constructor+" already exists on node "+a.$node[0])})},this.removeInstance=function(a){var b=this.instances.filter(function(b){return b.instance==a})[0],c=this.instances.indexOf(b);c>-1&&this.instances.splice(c,1),this.instances.length||d.removeComponentInfo(this)}}function f(a){this.instance=a,this.events=[],this.addTrigger=function(){},this.addBind=function(a){this.events.push(a),d.events.push(a)},this.removeBind=function(a){for(var b=0,d;d=this.events[b];b++)c(d,a)&&this.events.splice(b,1)}}var d=this;(this.reset=function(){this.components=[],this.allInstances=[],this.events=[]}).call(this),this.addInstance=function(a){var b=this.findComponentInfo(a);b||(b=new e(a.constructor),this.components.push(b));var c=b.addInstance(a);return this.allInstances.push(c),b},this.removeInstance=function(a){var b,c=this.findInstanceInfo(a),d=this.findComponentInfo(a);d.removeInstance(a);var b=this.allInstances.indexOf(c);b>-1&&this.allInstances.splice(b,1)},this.removeComponentInfo=function(a){var b=this.components.indexOf(a);b>-1&&this.components.splice(b,1)},this.findComponentInfo=function(a){var b=a.attachTo?a:a.constructor;for(var c=0,d;d=this.components[c];c++)if(d.component===b)return d;return null},this.findInstanceInfo=function(a){var b;a.node?b=function(b){return b.instance===a}:b=function(b){return b.instance.node===a};var c=this.allInstances.filter(b);return c.length?a.node?c[0]:c:a.node?null:[]},this.trigger=function(){var a=b(this,arguments),c=d.findInstanceInfo(this);c&&c.addTrigger(a)},this.on=function(c){var e=a.toArray(arguments,1),f=d.findInstanceInfo(this),g;if(f){g=c.apply(null,e),g&&(e[e.length-1]=g);var h=b(this,e);f.addBind(h)}},this.off=function(a,c,e){var f=b(this,arguments),g=d.findInstanceInfo(this);g&&g.removeBind(f)},this.teardown=function(){d.removeInstance(this)},this.withRegistration=function(){this.before("initialize",function(){d.addInstance(this)}),this.after("trigger",d.trigger),this.around("on",d.on),this.after("off",d.off),this.after("teardown",{obj:d,fnName:"teardown"})}}return new d})
define("components/flight/lib/debug",["./registry","./utils"],function(a,b){function d(a,b,c){var c=c||{},e=c.obj||window,g=c.path||(e==window?"window":""),h=Object.keys(e);h.forEach(function(c){(f[a]||a)(b,e,c)&&console.log([g,".",c].join(""),"->",["(",typeof e[c],")"].join(""),e[c]),Object.prototype.toString.call(e[c])=="[object Object]"&&e[c]!=e&&g.split(".").indexOf(c)==-1&&d(a,b,{obj:e[c],path:[g,c].join(".")})})}function e(a,b,c,e){!b||typeof c==b?d(a,c,e):console.error([c,"must be",b].join(" "))}function g(a,b){e("name","string",a,b)}function h(a,b){e("nameContains","string",a,b)}function i(a,b){e("type","function",a,b)}function j(a,b){e("value",null,a,b)}function k(a,b){e("valueCoerced",null,a,b)}function l(a,b){d(a,null,b)}function n(){var a=[].slice.call(arguments,0);c.eventNames.length||(c.eventNames="all"),c.actions=a.length?a:"all"}function o(){var a=[].slice.call(arguments,0);c.actions.length||(c.actions="all"),c.eventNames=a.length?a:"all"}function p(){c.actions=[],c.eventNames=[]}function q(){c.actions="all",c.eventNames="all"}var c,f={name:function(a,b,c){return a==c},nameContains:function(a,b,c){return c.indexOf(a)>-1},type:function(a,b,c){return b[c]instanceof a},value:function(a,b,c){return b[c]===a},valueCoerced:function(a,b,c){return b[c]==a}},m=document.cookie&&document.cookie.indexOf("swift_event_logging=all")==-1?[]:"all";return c={actions:m,eventNames:m},{enable:function(a){this.enabled=!!a,a&&window.console&&(console.info("Booting in DEBUG mode"),console.info("You can filter event logging with DEBUG.events.logAll/logNone/logByName/logByAction"))},find:{byName:g,byNameContains:h,byType:i,byValue:j,byValueCoerced:k,custom:l},events:{logFilter:c,logByAction:n,logByName:o,logAll:q,logNone:p}}})
define("components/flight/lib/compose",["./utils","./debug"],function(a,b){function f(a,b){if(!c)return;var e=Object.create(null);Object.keys(a).forEach(function(c){if(d.indexOf(c)<0){var f=Object.getOwnPropertyDescriptor(a,c);f.writable=b,e[c]=f}}),Object.defineProperties(a,e)}function g(a,b,d){var e;if(!c||!a.hasOwnProperty(b)){d.call(a);return}e=Object.getOwnPropertyDescriptor(a,b).writable,Object.defineProperty(a,b,{writable:!0}),d.call(a),Object.defineProperty(a,b,{writable:e})}function h(a,b){a.mixedIn=a.hasOwnProperty("mixedIn")?a.mixedIn:[],b.forEach(function(b){a.mixedIn.indexOf(b)==-1&&(f(a,!1),b.call(a),a.mixedIn.push(b))}),f(a,!0)}var c=b.enabled&&!a.isEnumerable(Object,"getOwnPropertyDescriptor"),d=["mixedIn"];if(c)try{Object.getOwnPropertyDescriptor(Object,"keys")}catch(e){c=!1}return{mixin:h,unlockProperty:g}})
define("components/flight/lib/advice",["./utils","./compose"],function(a,b){var c={around:function(b,c){return function(){var d=a.toArray(arguments);return c.apply(this,[b.bind(this)].concat(d))}},before:function(b,c){return this.around(b,function(){var b=a.toArray(arguments),d=b.shift(),e;return e=typeof c=="function"?c:c.obj[c.fnName],e.apply(this,b),d.apply(this,b)})},after:function(b,c){return this.around(b,function(){var b=a.toArray(arguments),d=b.shift(),e,f=(d.unbound||d).apply(this,b);return e=typeof c=="function"?c:c.obj[c.fnName],e.apply(this,b),f})},withAdvice:function(){["before","after","around"].forEach(function(a){this[a]=function(d,e){b.unlockProperty(this,d,function(){return typeof this[d]=="function"?this[d]=c[a](this[d],e):this[d]=e})}},this)}};return c})
define("components/flight/lib/component",["./advice","./utils","./compose","./registry"],function(a,b,c,d){function e(a){a.events.slice().forEach(function(a){var b=[a.type];a.element&&b.unshift(a.element),typeof a.callback=="function"&&b.push(a.callback),this.off.apply(this,b)},a.instance)}function f(){e(d.findInstanceInfo(this)),this.trigger("componentTornDown")}function g(){var a=d.findComponentInfo(this);a&&a.instances.slice().forEach(function(a){a.instance.teardown()})}function h(){this.trigger=function(){var a,c,d,e=b.toArray(arguments);typeof e[e.length-1]!="string"&&(d=e.pop()),a=e.length==2?$(e.shift()):this.$node,c=e[0];if(window.DEBUG&&window.postMessage)try{window.postMessage(d,"*")}catch(f){throw console.log("unserializable data for event",c,":",d),new Error(["The event",event.type,"on component",this.describe,"was triggered with non-serializable data"].join(" "))}return typeof this.attr.eventData=="object"&&(d=$.extend(!0,{},this.attr.eventData,d)),a.trigger(c,d)},this.on=function(){var a,c,d,e,f=b.toArray(arguments);typeof f[f.length-1]=="object"?e=b.delegate(this.resolveDelegateRules(f.pop())):e=f.pop(),d=e&&e.bind(this),d.target=e,a=f.length==2?$(f.shift()):this.$node,c=f[0];if(typeof d=="undefined")throw new Error("Unable to bind to '"+c+"' because the given callback is undefined");return a.on(c,d),d},this.off=function(){var a,c,d,e=b.toArray(arguments);return typeof e[e.length-1]=="function"&&(d=e.pop()),a=e.length==2?$(e.shift()):this.$node,c=e[0],a.off(c,d)},this.resolveDelegateRules=function(a){var b={};return Object.keys(a).forEach(function(c){if(!this.attr.hasOwnProperty(c))throw new Error('Component "'+this.describe+'" wants to listen on "'+c+'" but no such attribute was defined.');b[this.attr[c]]=a[c]},this),b},this.defaultAttrs=function(a){b.push(this.defaults,a,!0)||(this.defaults=a)},this.select=function(a){return this.$node.find(this.attr[a])},this.initialize=$.noop,this.teardown=f}function i(a){if(!a)throw new Error("Component needs to be attachTo'd a jQuery object, native node or selector string");var c=b.merge.apply(b,b.toArray(arguments,1));$(a).each(function(a,b){new this(b,c)}.bind(this))}function j(){function f(a,c){var d={},e=0;if(!a)throw new Error("Component needs a node");a.jquery?(this.node=a[0],this.$node=a):(this.node=a,this.$node=$(a)),this.describe=this.constructor.describe,this.bind=function(a){var c;if(a.uuid&&(c=d[a.uuid]))return c;var f=b.toArray(arguments,1);return f.unshift(this),c=a.bind.apply(a,f),c.target=a,a.uuid=e++,d[a.uuid]=c,c},this.attr=b.merge(this.defaults,c),this.initialize.call(this,c||{}),this.trigger("componentInitialized")}var e=b.toArray(arguments);return f.toString=function(){var a=e.map(function(a){if($.browser.msie){var b=a.toString().match(/function (.*?)\s?\(/);return b&&b[1]?b[1]:""}return a.name}).join(", ").replace(/\s\,/g,"");return a},f.describe=f.toString(),f.attachTo=i,f.teardownAll=g,e.unshift(h,a.withAdvice,d.withRegistration),c.mixin(f.prototype,e),f}return j.teardownAll=function(){d.components.slice().forEach(function(a){a.component.teardownAll()}),d.reset()},j})
define("core/component",["module","require","exports","components/flight/lib/component"],function(module, require, exports) {
var flightComponent=require("components/flight/lib/component");module.exports=flightComponent
});
define("core/registry",["module","require","exports","components/flight/lib/registry"],function(module, require, exports) {
var flightRegistry=require("components/flight/lib/registry");module.exports=flightRegistry
});
provide("core/clock",function(a){using("core/component","core/registry",function(b,c){function h(){}function i(){this.timers=[],this.clockComponent=function(){if(!this.currentClock||!c.findInstanceInfo(this.currentClock))this.reset(),this.currentClock=new d(document);return this.currentClock},this.trigger=function(a,b){this.clockComponent().trigger(a,b)},this.reset=function(){this.timers=[]},this.tick=function(){this.timers.forEach(function(a){a.tick(f)})},this.setTicker=function(){this.pause(),this.ticker=window.setInterval(this.tick.bind(this),f)},this.init=function(){this.clockComponent(),this.ticker||this.setTicker()},this.clear=function(a){a&&this.timers.splice(this.timers.indexOf(a),1)},this.setTimeoutEvent=function(a,b,c){if(typeof a!="string")return console.error("clock.setTimeoutEvent was passed a function instead of a string.");this.init();var d=new k(a,b,c);return this.timers.push(d),d},this.clearTimeout=function(a){a instanceof k&&this.clear(a)},this.setIntervalEvent=function(a,b,c){if(typeof a!="string")return console.error("clock.setIntervalEvent was passed a function instead of a string.");this.init();var d=new m(a,b,c);return this.timers.push(d),d},this.clearInterval=function(a){a instanceof m&&this.clear(a)},this.resume=this.restart=this.setTicker,this.pause=function(a,b){clearInterval(this.ticker||0)}}function j(){this.callback=function(){e.trigger(this.eventName,this.data)},this.clear=function(){e.clear(this)},this.pause=function(){this.paused=!0},this.resume=function(){this.paused=!1},this.tickUnlessPaused=this.tick,this.tick=function(){if(this.paused)return;this.tickUnlessPaused.apply(this,arguments)}}function k(a,b,c){this.countdown=b,this.eventName=a,this.data=c}function m(a,b,c){this.countdown=this.interval=this.maxInterval=this.initialInterval=b,this.backoffFactor=g,this.eventName=a,this.data=c}var d=b(h),e=new i,f=1e3,g=2,l=function(){this.tick=function(a){this.countdown-=a,this.countdown<=0&&(this.clear(),this.callback())}};l.call(k.prototype),j.call(k.prototype);var n=function(){this.tick=function(a){this.countdown-=a;if(this.countdown<=0){this.callback();if(this.interval<this.maxInterval){var b=Math.ceil(this.interval*this.backoffFactor/f)*f;this.interval=Math.min(b,this.maxInterval)}this.countdown=this.interval}},this.backoff=function(a,b){this.maxInterval=a,this.backoffFactor=b||g,this.interval>this.maxInterval&&(this.interval=a)},this.cancelBackoff=function(){this.countdown=this.interval=this.maxInterval=this.initialInterval,this.resume()}};n.call(m.prototype),j.call(m.prototype),a(e)})})
define("core/compose",["module","require","exports","components/flight/lib/compose"],function(module, require, exports) {
var flightCompose=require("components/flight/lib/compose");module.exports=flightCompose
});
define("core/advice",["module","require","exports","components/flight/lib/advice"],function(module, require, exports) {
var flightAdvice=require("components/flight/lib/advice");module.exports=flightAdvice
});
provide("core/parameterize",function(a){function c(a,c,d){return c?a.replace(b,function(a,b){if(b){if(c[b])return c[b];if(d)throw new Error("Cannot parameterize string, no replacement found for "+b);return""}return a}):a}var b=/\{\{(.+?)\}\}/g;a(c)})
provide("core/i18n",function(a){using("core/parameterize",function(b){a(b)})})
define("components/flight/lib/logger",["./compose","./utils"],function(a,b){function d(a){var b=a.tagName?a.tagName.toLowerCase():a.toString(),c=a.className?"."+a.className:"",d=b+c;return a.tagName?["'","'"].join(d):d}function e(a,b,e){var f,g,h,i,j,k,l,m;typeof e[e.length-1]=="function"&&(h=e.pop(),h=h.unbound||h),typeof e[e.length-1]=="object"&&e.pop(),e.length==2?(g=e[0],f=e[1]):(g=b.$node[0],f=e[0]),window.DEBUG&&(j=DEBUG.events.logFilter,l=j.actions=="all"||j.actions.indexOf(a)>-1,k=function(a){return a.test?a:new RegExp("^"+a.replace(/\*/g,".*")+"$")},m=j.eventNames=="all"||j.eventNames.some(function(a){return k(a).test(f)}),l&&m&&console.info(c[a],a,"["+f+"]",d(g),b.constructor.describe,h&&(i=h.name||h.displayName)&&"->  "+i))}function f(){this.before("trigger",function(){e("trigger",this,b.toArray(arguments))}),this.before("on",function(){e("on",this,b.toArray(arguments))}),this.before("off",function(a){e("off",this,b.toArray(arguments))})}var c={on:"<-",trigger:"->",off:"x "};return f})
define("core/logger",["module","require","exports","components/flight/lib/logger"],function(module, require, exports) {
var flightLogger=require("components/flight/lib/logger");module.exports=flightLogger
});
define("core/utils",["module","require","exports","components/flight/lib/utils"],function(module, require, exports) {
var flightUtils=require("components/flight/lib/utils");module.exports=flightUtils
});
define("debug/debug",["module","require","exports","components/flight/lib/debug"],function(module, require, exports) {
var flightDebug=require("components/flight/lib/debug");module.exports=flightDebug
});
provide("app/utils/querystring",function(a){function b(a){return encodeURIComponent(a).replace(/\+/g,"%2B")}function c(a){return decodeURIComponent(a)}function d(a){var c=[];for(var d in a)a[d]!==null&&typeof a[d]!="undefined"&&c.push(b(d)+"="+b(a[d]));return c.sort().join("&")}function e(a){var b={},d,e,f,g;if(a){d=a.split("&");for(g=0;f=d[g];g++)e=f.split("="),e.length==2&&(b[c(e[0])]=c(e[1]))}return b}a({decode:e,encode:d,encodePart:b,decodePart:c})})
define("app/utils/params",["module","require","exports","app/utils/querystring"],function(module, require, exports) {
var qs=require("app/utils/querystring"),fromQuery=function(a){var b=a.search.substr(1);return qs.decode(b)},fromFragment=function(a){var b=a.href,c=b.indexOf("#"),d=c<0?"":b.substring(c+1);return qs.decode(d)},combined=function(a){var b={},c=fromQuery(a),d=fromFragment(a);for(var e in c)c.hasOwnProperty(e)&&(b[e]=c[e]);for(var e in d)d.hasOwnProperty(e)&&(b[e]=d[e]);return b};module.exports={combined:combined,fromQuery:fromQuery,fromFragment:fromFragment}
});
provide("app/utils/auth_token",function(a){var b;a({get:function(){if(!b)throw new Error("authToken should have been set!");return b},set:function(a){b=a},addTo:function(a,c){return a.authenticity_token=b,c&&(a.post_authenticity_token=b),a}})})
define("app/data/scribe_transport",["module","require","exports"],function(module, require, exports) {
function ScribeTransport(a){this.SESSION_BUFFER_KEY="ScribeTransport",this.SCRIBE_API_ENDPOINT="/i/jot",this.options={},a&&(this.updateOptions(a),this.registerEventHandlers(a))}ScribeTransport.prototype={flush:function(a,b){if(!a||!a.length)return;b===undefined&&(b=!!this.options.sync),this.options.useAjax?$.ajax({url:this.options.url,data:this.ajaxParams(a),type:"POST",async:!b}):(new Image).src=this.options.url+"/?q="+(+(new Date)).toString().slice(-4)+"&"+this.imageParams(a),this.reset()},ajaxParams:function(a){if(typeof a=="string")return{log:"["+a+"]"};var b=this.options.encodeParameters;return b&&typeof b=="function"?b.apply(this,arguments):{log:JSON.stringify(a)}},imageParams:function(a){if(typeof a=="string")return"log=%5B"+a+"%5D";var b=this.options.encodeParameters;return b&&typeof b=="function"?b.apply(this,arguments):"log="+encodeURIComponent(JSON.stringify(a))},reset:function(){this.options.bufferEvents&&(this.skipUnloadFlush=!1,sessionStorage.removeItem(this.options.bufferKey))},getBuffer:function(){return sessionStorage.getItem(this.options.bufferKey)||""},send:function(a,b,c){if(!b||!a||this.options.bufferSize<0)return;a._category_=b;if(c||!this.options.bufferEvents||!this.options.bufferSize)this.flush([a],c);else{var d=JSON.stringify(a);this.options.useAjax||(d=encodeURIComponent(d));var e=this.getBuffer(),f=e+(e?this.SEPARATOR+d:d);this.options.bufferSize&&this.fullBuffer(f)?this.options.useAjax?this.flush(f):(this.flush(e),sessionStorage.setItem(this.options.bufferKey,d)):sessionStorage.setItem(this.options.bufferKey,f)}this.postToConsole(a),this.options.metrics&&a.event_info!="debug"&&$(document).trigger("debugscribe",a)},fullBuffer:function(a){return a.length>=(this.options.useAjax?this.options.bufferSize*2083:2050-this.options.url.length)},updateOptions:function(a){this.options=$.extend({},this.options,a),this.options.flushOnUnload===undefined&&(this.options.flushOnUnload=!0),this.options.bufferKey||(this.options.bufferKey=this.SESSION_BUFFER_KEY),this.options.bufferSize===0&&(this.options.bufferEvents=!1),this.options.useAjax===undefined&&(this.options.useAjax=!0);if(this.options.bufferEvents||this.options.bufferEvents==undefined)try{sessionStorage.setItem(this.SESSION_BUFFER_KEY+".init","test");var b=sessionStorage.getItem(this.SESSION_BUFFER_KEY+".init")=="test";sessionStorage.removeItem(this.SESSION_BUFFER_KEY+".init"),this.options.bufferEvents=b}catch(c){this.options.bufferEvents=!1}var d=window.location.protocol==="https:"?"https:":"http:";this.options.url===undefined?this.options.useAjax?this.options.url=this.SCRIBE_API_ENDPOINT:this.options.url="https://twitter.com"+this.SCRIBE_API_ENDPOINT:this.options.url=this.options.url.replace(/^[a-z]+:/g,d).replace(/\/$/,""),this.options.bufferEvents&&this.options.bufferSize===undefined&&(this.options.bufferSize=20)},appHost:function(){return window.location.host},registerEventHandlers:function(){var a=this,b=$(document);if(this.options.bufferEvents){b.on("flushscribe."+a.options.bufferKey,function(b){a.flush(a.getBuffer(),!0)});if(this.options.flushOnUnload){var c=function(b){a.skipUnloadFlush=!b||!b.match(/http/)||!!b.match(new RegExp("^https?://"+a.appHost(),"gi")),a.skipUnloadFlush&&window.setTimeout(function(){a.skipUnloadFlush=!1},3e3)};b.on("mouseup."+this.options.bufferKey,"a",function(a){if(this.getAttribute("target")||a.button||a.metaKey||a.shiftKey||a.altKey||a.ctrlKey)return;c(this.getAttribute("href"))}),b.on("submit."+this.options.bufferKey,"form",function(a){c(this.getAttribute("action"))}),b.on("uiNavigate."+this.options.bufferKey,function(a,b){c(b.url)}),$(window).on("unload."+this.options.bufferKey,function(){a.skipUnloadFlush||a.flush(a.getBuffer(),!0),a.skipUnloadFlush=!1})}}this.options.debug&&window.postMessage&&$(document).keypress(function(a){if(a.charCode==205&&a.shiftKey&&a.altKey){var b="menubar=no,toolbar=no,personalbar=no,location=no,resizable=yes,status=no,dependent=yes,height=600,width=600,screenX=100,screenY=100,scrollbars=yes",c=window.location.host;if(!c||!c.match(/^(staging[0-9]+\.[^\.]+\.twitter.com|twitter\.com|localhost\.twitter\.com\:[0-9]+)$/))c="twitter.com";window.scribeConsole=window.open(window.location.protocol+"//"+c+"/scribe/console","scribe_console",b)}}),this.SEPARATOR=this.options.useAjax?",":encodeURIComponent(",")},postToConsole:function(a){if(this.options.debug&&window.scribeConsole&&window.scribeConsole.postMessage){var b=window.location.protocol+"//"+window.location.host;try{window.scribeConsole.postMessage(a,b)}catch(c){var d="ScribeTransport.postToConsole - Scribe Console error or unserializable data ["+a._category_+"]";console.error(d,a)}}},destroy:function(){this.flush(this.getBuffer()),$(document).off("flushscribe."+this.options.bufferKey),$(window).off("unload."+this.options.bufferKey),$(document).off("mouseup."+this.options.bufferKey),$(document).off("submit."+this.options.bufferKey),$(document).off("uiNavigate."+this.options.bufferKey)}},module.exports=new ScribeTransport
});
define("app/data/client_event",["module","require","exports","app/data/scribe_transport"],function(module, require, exports) {
function ClientEvent(a){this.scribeContext={},this.scribeData={},this.scribe=function(b,c){var d=a||window.scribeTransport;if(!d)throw new Error("You must create a global scribeTransport variable or pass one into this constructor.");if(!b||typeof b!="object"||c&&typeof c!="object")throw new Error("Invalid terms or data hash argument when calling ClientEvent.scribe().");if(this.scribeContext){var e=typeof this.scribeContext=="function"?this.scribeContext():this.scribeContext;b=$.extend({},e,b)}for(var f in b)b[f]=b[f]&&(""+b[f]).toLowerCase().replace(/_?[^a-z0-9_]+_?/g,"_");d.options.debug&&$.each(["client","page","section","action"],function(a,c){if(!b[c])throw new Error("You must specify a "+c+" term in your client_event.")});var c=$.extend({},c);if(this.scribeData){var g=typeof this.scribeData=="function"?this.scribeData():this.scribeData;c=$.extend({},g,c)}c.event_namespace=b,c.triggered_on=c.triggered_on||+(new Date),c.format_version=1,d.send(c,"client_event")}}var scribeTransport=require("app/data/scribe_transport");module.exports=new ClientEvent(scribeTransport)
});
define("app/data/with_scribe",["module","require","exports","app/data/client_event","core/utils"],function(module, require, exports) {
function withScribe(){function a(a){if(!a)return;a=a.sourceEventData?a.sourceEventData:a;if(a.scribeContext||a.scribeData)return a}this.scribe=function(){var b=Array.prototype.slice.call(arguments),c,d,e,f,g;c=typeof b[0]=="string"?{action:b[0]}:b[0],b.shift();if(b[0]){e=b[0],e.sourceEventData&&(e=e.sourceEventData);if(e.scribeContext||e.scribeData)f=e.scribeContext,g=e.scribeData;(b[0].scribeContext||b[0].scribeData||b[0].sourceEventData||b.length===2)&&b.shift()}c=utils.merge({},f,c),d=typeof b[0]=="function"?b[0].bind(this)(e):b[0],d=utils.merge({format_version:1,triggered_on:+(new Date)},g,d),this.transport(c,d)},this.scribeOnEvent=function(b,c,d){this.on(b,function(a,b){b=b||{},this.scribe(c,b.sourceEventData||b,d)})},this.transport=function(b,c){clientEvent.scribe(b,c)}}var clientEvent=require("app/data/client_event"),utils=require("core/utils");module.exports=withScribe
});
define("app/data/scribe_monitor",["module","require","exports","core/component","app/data/scribe_transport","app/data/client_event","app/data/with_scribe","core/utils"],function(module, require, exports) {
function scribeMonitor(){this.bufferedScribeDebug=function(a,b){this.scribe(utils.merge({component:"buffered"},a),{event_info:"debug",event_initiator:2})},this.imageScribeDebug=function(a,b){b.event_namespace=utils.merge({component:"image_beacon"},a),b.event_initiator=2,(new Image).src=window.location.protocol+"//"+window.location.host+"/scribe/?ts="+ +(new Date)+"&log%5B%5D="+encodeURIComponent(JSON.stringify(b))},this.asyncAjaxScribeDebug=function(a,b){this.ajaxScribeDebug(a,b,!0)},this.syncAjaxScribeDebug=function(a,b){this.ajaxScribeDebug(a,b,!1)},this.ajaxScribeDebug=function(a,b,c){b.event_namespace=utils.merge({component:c?"asynchronous_ajax":"synchronous_ajax"},a),b.event_initiator=2,$.ajax({url:"/scribe",data:{log:[JSON.stringify(b)]},type:"POST",async:c})};var a=["bufferedScribeDebug","imageScribeDebug","syncAjaxScribeDebug","asyncAjaxScribeDebug"];this.after("initialize",function(){if(Math.random()<=this.attr.userFraction){this.scribe({component:"buffered_page_impression",action:"debug"},{event_info:"debug",event_initiator:2});var b={event_namespace:{client:"web",page:clientEvent.scribeContext.page,section:clientEvent.scribeContext.section,component:"ajax_page_impression",action:"debug"},event_info:"debug",event_initiator:2,_category_:"client_event"};$.ajax({url:"/scribe",data:{log:[JSON.stringify(b)]},type:"POST"})}this.attr.userFraction&&this.on("debugscribe",function(b,c){if(c["_category_"]=="client_event"){c.event_info="debug";var d={client:"web",page:c.event_namespace.page,section:c.event_namespace.section,action:"debug"};this[a[Math.floor(Math.random()*4)]](d,c)}}),this.attr.scribesForScribeConsole&&this.on("uiSwiftLoaded uiPageChanged",function(a,b){(a.type=="uiSwiftLoaded"||!b.fromCache)&&this.attr.scribesForScribeConsole.forEach(function(a){a._category_="client_event",scribeTransport.postToConsole(a)})})})}var defineComponent=require("core/component"),scribeTransport=require("app/data/scribe_transport"),clientEvent=require("app/data/client_event"),withScribe=require("app/data/with_scribe"),utils=require("core/utils");module.exports=defineComponent(scribeMonitor,withScribe)
});
define("app/data/ddg",["module","require","exports","app/data/client_event"],function(module, require, exports) {
function DDG(a,b){this.experiments=a||{},this.impressions={},this.scribeExperiment=function(a,c,d){var e=$.extend({page:"ddg",section:a.experiment_key,component:"",element:""},c);d=d||{},d.experiment_key=a.experiment_key,d.bucket=a.bucket,d.version=a.version,(b||window.clientEvent).scribe(e,d)},this.impression=function(a){var b=this.experiments[a];b&&(a=b.experiment_key,this.impressions[a]||(this.scribeExperiment(b,{action:"experiment"}),this.impressions[a]=!0))},this.track=function(a,b,c){if(!b)throw new Error("You must specify an event name to track custom DDG events. Event names should be lower-case, snake_cased strings.");var d=this.experiments[a];d&&this.scribeExperiment(d,{element:b,action:"track"},c)},this.bucket=function(a){var b=this.experiments[a];return b?b.bucket:""}}var clientEvent=require("app/data/client_event");module.exports=new DDG({},clientEvent)
});
define("app/ui/with_interaction_data",["module","require","exports","core/utils"],function(module, require, exports) {
function withInteractionData(){this.defaultAttrs({expandoItemSelector:".simple-tweet",expandoContainerSelector:".replies-to, .in-reply-to, .js-expando-content",streamItemContainerSelector:".js-stream-item",activityTargetSelector:".activity-truncated-tweet .js-actionable-tweet, .js-activity-list_member_added [data-list-id]",activityItemSelector:".js-activity",itemAvatarSelector:".js-action-profile-avatar, .avatar.size48",itemSmallAvatarSelector:".avatar.size24, .avatar.size32",itemMentionSelector:".twitter-atreply",discoveryStoryItemSelector:".js-story-item",discoveryStoryHeadlineSelector:".js-news-headline a",originalTweetSelector:".js-original-tweet[data-tweet-id]",promotedBadgeSelector:".js-promoted-badge",elementContextSelector:"[data-element-context]",componentContextSelector:"[data-component-context]",scribeContextSelector:"[data-scribe-context]"});var a={feedbackToken:"data-feedback-token",impressionId:"data-impression-id",disclosureType:"data-disclosure-type",impressionCookie:"data-impression-cookie",relevanceType:"data-relevance-type",associatedTweetId:"data-associated-tweet-id"},b=utils.merge({tweetId:"data-tweet-id",retweetId:"data-retweet-id",isReplyTo:"data-is-reply-to"},a),c=utils.merge({activityType:"data-activity-type",itemKey:"data-item-key"},b),d=utils.merge({storyType:"data-story-type",query:"data-query",url:"data-url",storySource:"data-source",storyMediaType:"data-card-media-type",itemKey:"data-item-key"},b);this.interactionData=function(a,b){var c={},d={},e=a.target?$(a.target):$(a);b=b||{},this.attr.eventData&&(c=this.attr.eventData.scribeContext,d=this.attr.eventData.scribeData);var f=utils.merge(this.getEventData(e),b),g=e.closest(this.attr.scribeContextSelector).data("scribe-context");g&&(d=utils.merge(g,d)),c=utils.merge({},c,this.getScribeContext(e,f));if(this.attr.itemType=="tweet"&&(c.component=="replies"||c.component=="conversation")){var h=e.closest(this.attr.streamItemContainerSelector).find(this.attr.originalTweetSelector);h.length&&(f.conversationOriginTweetId=h.attr("data-tweet-id"))}return utils.merge({scribeContext:c,scribeData:d},f)},this.getScribeContext=function(a,b){var c={},d=a.closest(this.attr.componentContextSelector).attr("data-component-context");d&&(c.component=d);var e=a.closest(this.attr.elementContextSelector).attr("data-element-context");e&&(c.element=e);if(c.element||c.component)return c},this.getInteractionItemPosition=function(a,b){if(b&&b.position>=0)return b.position;var c=this.getItemPosition&&this.getItemPosition(a);return c>=0?c:(c=this.getExpandoPosition(a),c!=-1?c:a.attr("data-is-tweet-proof")==="true"?this.getTweetProofPosition(a):this.getStreamPosition(a))},this.getExpandoPosition=function(a){var b=a.closest(this.attr.expandoContainerSelector);return b.length?b.find(this.attr.expandoItemSelector).index(a.closest(this.attr.expandoItemSelector)):-1},this.getTweetProofPosition=function(a){var b=a.closest(this.attr.trendItemSelector).index();return b!=-1?b:-1},this.getStreamPosition=function(a){var b=a.closest(this.attr.genericItemSelector).index();if(b!=-1)return b},this.getEventData=function(c){var d;switch(this.attr.itemType){case"activity":return this.getActivityEventData(c);case"story":return this.getStoryEventData(c);case"user":return this.getDataAttrs(c,a);case"tweet":return this.getDataAttrs(c,b);case"list":return this.getDataAttrs(c,a);case"trend":return this.getDataAttrs(c,b);default:return console.warn('You must configure your UI component with an "itemType" attribute of activity, story, user, tweet, list, or trend in order for it to scribe properly.'),{}}},this.getActivityEventData=function(a){var b=a.closest(this.attr.activityItemSelector).find(this.attr.activityTargetSelector);b.length||(b=a);var d=this.getDataAttrs(a,c,b);return d.activityType==="list_member_added"&&(d.activityType="list"),d.activityType||(d.isReplyTo?d.activityType="reply":d.activityType=d.retweetId?"retweet":"mention"),d},this.getStoryEventData=function(a){var b=this.getDataAttrs(a,d),c=a.closest(this.attr.discoveryStoryItemSelector),e=c.find(this.attr.discoveryStoryHeadlineSelector).text();return b.storyTitle=e.replace(/^\s+|\s+$/g,""),b},this.getDataAttrs=function(a,b,c){var d={};return c=c||a,$.each(b,function(a,b){c.is("["+b+"]")?d[a]=c.attr(b):d[a]=c.closest("["+b+"]").attr(b)}),d.isReplyTo=d.isReplyTo==="true",d=utils.merge(d,{position:this.getInteractionItemPosition(a,d),isMentionClick:a.closest(this.attr.itemMentionSelector).length>0,isPromotedBadgeClick:a.closest(this.attr.promotedBadgeSelector).length>0,itemType:this.attr.itemType}),a.is(this.attr.itemAvatarSelector)?d.profileClickTarget="avatar":a.is(this.attr.itemSmallAvatarSelector)?d.profileClickTarget="mini_avatar":d.profileClickTarget="screen_name",d.userId=a.closest("[data-user-id]").attr("data-user-id"),d}}var utils=require("core/utils");module.exports=withInteractionData
});
define("app/utils/scribe_item_types",["module","require","exports"],function(module, require, exports) {
module.exports={tweet:0,promotedTweet:1,popularTweet:2,retweet:10,user:3,promotedUser:4,message:6,story:7,trend:8,promotedTrend:9,popularTrend:15,list:11,search:12,savedSearch:13,peopleSearch:14}
});
define("app/utils/scribe_association_types",["module","require","exports"],function(module, require, exports) {
module.exports={associatedTweet:1,platformCardPublisher:2,platformCardCreator:3,conversationOrigin:4}
});
define("app/data/with_interaction_data_scribe",["module","require","exports","core/compose","app/data/with_scribe","app/utils/scribe_item_types","app/utils/scribe_association_types","core/utils"],function(module, require, exports) {
function withInteractionDataScribe(){compose.mixin(this,[withScribe]),this.scribeInteraction=function(a,b,c){var d=[],e=[],f=[],g={};if(!a||!b)return;typeof a=="string"&&(a={action:a});if(!a.action)return;b=utils.merge(b,b.sourceEventData),this.insertInteractionData(b,a,d,e,f,g),a=this.getInteractionScribeContext(a,b),c=utils.merge({item_ids:d.length?d:null,item_names:e.length?e:null,tokens:f.length?f:null,item_count:1,item_details:g,url:b.url,query:b.query,promoted:!!b.impressionId,message:b.storyTitle},c,b.scribeData),b.conversationOriginTweetId&&(c.associations=c.associations||{},c.associations[associationTypes.conversationOrigin]={association_id:b.conversationOriginTweetId,association_type:itemTypes.tweet}),this.scribe(a,b,c)},this.insertInteractionData=function(a,b,c,d,e,f,g){var h,i,j,k,l;switch(a.itemType){case"user":c.push(a.userId),i=itemTypes.user,l=a.userId;break;case"tweet":c.push(a.tweetId),i=itemTypes.tweet,l=a.tweetId;break;case"activity":a.activityType==="follow"?(c.push(a.userId),i=itemTypes.user):a.listId?(c.push(a.listId),i=itemTypes.list):(c.push(a.tweetId),i=itemTypes.tweet),a.itemKey&&d.push(a.itemKey),k=a.activityType,l=a.itemKey;break;case"story":a.tweetId||a.userId?(c.push(a.tweetId||a.userId),i=a.tweetId?itemTypes.tweet:itemTypes.user):i=itemTypes.story,a.itemKey&&d.push(a.itemKey),k=a.storyType,l=a.itemKey}a.itemType==="user"||this.isUserTarget(b.action)?(h=a.userId,j=itemTypes.user):a.listId?(h=a.listId,j=itemTypes.list):a.retweetId?(i=itemTypes.retweet,h=a.retweetId,j=itemTypes.tweet):a.tweetId?(h=a.tweetId,j=itemTypes.tweet):j=i,(a.feedbackToken||a.storySource)&&e.push(a.feedbackToken||a.storySource),a.impressionId&&(i===itemTypes.tweet||i===itemTypes.user)&&(h===c[0]&&j===i&&j++,i++),a.relevanceType&&i===itemTypes.tweet&&(i=itemTypes.popularTweet,j===itemTypes.tweet&&(j=itemTypes.popularTweet));if(l){if(g&&this.isMundaneType(a,i,j))return;f[l]={item_type:i,target_id:h,target_type:j,item_position:a.position,item_token:a.impressionId,item_description:k}}},this.isMundaneType=function(a,b,c){return(a.itemType==="user"||a.itemType==="tweet")&&(b===itemTypes.user||b===itemTypes.tweet)&&(c===itemTypes.user||c===itemTypes.tweet)},this.isUserTarget=function(a){return["mention_click","profile_click","follow","unfollow","block","unblock","report_as_spam","add_to_list","dm"].indexOf(a)!=-1},this.getInteractionScribeContext=function(a,b){return a.action=="profile_click"&&a.element===undefined&&(a.element=b.isPromotedBadgeClick?"promoted_badge":b.profileClickTarget),a},this.scribeInteractiveResults=function(a,b,c,d){var e=[],f=[],g=[],h=!1,i={};typeof a=="string"&&(a={action:a});if(!a.action||!b)return;b.length||(a.action="no_results"),b.forEach(function(b){h||(h=!!b.impressionId),this.insertInteractionData(b,a,e,f,g,i,!0)}.bind(this)),a=this.getInteractionScribeContext(a,c),d=utils.merge({item_ids:e.length?e:null,item_names:f.length?f:null,tokens:g.length?g:null,item_count:b.length,item_details:i,promoted:h},d),this.scribe(a,c,d)}}var compose=require("core/compose"),withScribe=require("app/data/with_scribe"),itemTypes=require("app/utils/scribe_item_types"),associationTypes=require("app/utils/scribe_association_types"),utils=require("core/utils");module.exports=withInteractionDataScribe
});
define("app/data/tweet_actions_scribe",["module","require","exports","core/component","core/utils","app/ui/with_interaction_data","app/data/with_interaction_data_scribe"],function(module, require, exports) {
function tweetActionsScribe(){this.scribeTweet=function(a){return function(b,c){this.scribeInteraction({action:a},utils.merge(c,c.sourceEventData))}.bind(this)},this.after("initialize",function(){this.on("uiReplyButtonTweetSuccess",this.scribeTweet("reply")),this.on("uiDidRetweetSuccess",this.scribeTweet("retweet")),this.on("uiDidDeleteTweet",this.scribeTweet("delete")),this.on("dataDidFavoriteTweet",this.scribeTweet("favorite")),this.on("dataDidUnfavoriteTweet",this.scribeTweet("unfavorite")),this.on("dataDidUnretweet",this.scribeTweet("unretweet")),this.on("uiPermalinkClick",this.scribeTweet("permalink")),this.on("uiDidShareViaEmailSuccess",this.scribeTweet("share_via_email"))})}var defineComponent=require("core/component"),utils=require("core/utils"),withInteractionData=require("app/ui/with_interaction_data"),withInteractionDataScribe=require("app/data/with_interaction_data_scribe");module.exports=defineComponent(tweetActionsScribe,withInteractionData,withInteractionDataScribe)
});
define("app/data/user_actions_scribe",["module","require","exports","core/component","app/utils/scribe_item_types","app/utils/scribe_association_types","app/data/with_interaction_data_scribe"],function(module, require, exports) {
function userActionsScribe(){function a(a){var b=a&&a.associatedTweetId,c={};if(!b)return;return c[associationTypes.associatedTweet]={association_type:itemTypes.tweet,association_id:b},{associations:c}}this.defaultAttrs({urlToActionMap:{"/i/user/follow":"follow","/i/user/unfollow":"unfollow","/i/user/block":"block","/i/user/unblock":"unblock","/i/user/report_spam":"report_as_spam","/i/user/hide":"dismiss"},userActionToActionMap:{uiMentionAction:"reply",uiDmAction:"dm",uiListAction:"add_to_list"}}),this.handleUserEvent=function(b,c){this.scribeInteraction(this.attr.urlToActionMap[c.requestUrl],c,a(c.sourceEventData))},this.handleAction=function(b,c){this.scribeInteraction(this.attr.userActionToActionMap[b.type],c,a(c))},this.after("initialize",function(){this.on(document,"dataFollowStateChange dataUserActionSuccess",this.handleUserEvent),this.on(document,"uiMentionAction uiListAction uiDmAction",this.handleAction)})}var defineComponent=require("core/component"),itemTypes=require("app/utils/scribe_item_types"),associationTypes=require("app/utils/scribe_association_types"),withInteractionDataScribe=require("app/data/with_interaction_data_scribe");module.exports=defineComponent(userActionsScribe,withInteractionDataScribe)
});
define("app/data/with_card_metadata",["module","require","exports","core/compose","app/utils/scribe_association_types","app/data/with_interaction_data_scribe","app/utils/scribe_item_types"],function(module, require, exports) {
function withCardMetadata(){compose.mixin(this,[withInteractionDataScribe]),this.cardAssociationsForData=function(a){var b={associations:{}};return b.associations[associationTypes.platformCardPublisher]={association_id:a.publisherUserId,association_type:itemTypes.user},b.associations[associationTypes.platformCardCreator]={association_id:a.creatorUserId,association_type:itemTypes.user},b.message=a.cardUrl,b},this.getCardDataFromTweet=function(a){var b={},c=a.closest(".tweet");b.tweetHasCard=c.hasClass("has-cards"),b.interactionInsideCard=!1;if(b.tweetHasCard){var d=c.find(".cards-base");b.cardType=d.data("card-type"),b.cardUrl=d.data("card-url"),b.publisherUserId=this.getUserIdFromElement(d.find(".source .js-user-profile-link")),b.creatorUserId=this.getUserIdFromElement(d.find(".byline .js-user-profile-link")),b.interactionInsideCard=this.interactionInsideCard(a)}return b},this.interactionInsideCard=function(a){return!!a.closest(".cards-base").length},this.scribeCardInteraction=function(a,b){var c=this.cardAssociationsForData(b);this.scribeInteraction({element:"platform_"+b.cardType+"_card",action:a},b,c)},this.getUserIdFromElement=function(a){return a.length?a.attr("data-user-id"):null}}var compose=require("core/compose"),associationTypes=require("app/utils/scribe_association_types"),withInteractionDataScribe=require("app/data/with_interaction_data_scribe"),itemTypes=require("app/utils/scribe_item_types");module.exports=withCardMetadata
});
define("app/data/item_actions_scribe",["module","require","exports","core/component","app/data/with_interaction_data_scribe","app/utils/scribe_association_types","app/data/with_card_metadata","app/utils/scribe_item_types"],function(module, require, exports) {
function itemActionsScribe(){this.handleNewerTimelineItems=function(a,b){this.scribeInteractiveResults({element:"newer",action:"results"},b.items,b)},this.handleProfilePopup=function(a,b){var c=b.sourceEventData,d=c.isMentionClick?"mention_click":"profile_click";c.userId=b.user_id,c.interactionInsideCard?this.scribeCardAction(d,a,c):this.scribeInteraction(d,c)},this.scribeItemAction=function(a,b,c){this.scribeInteraction(a,c)},this.scribeSearchTagClick=function(a,b){var c=a.type=="uiCashtagClick"?"cashtag":"hashtag";this.scribeInteraction({element:c,action:"search"},b)},this.scribeLinkClick=function(a,b){var c={};b.tcoUrl&&(c.message=b.tcoUrl),b.text&&b.text.indexOf("pic.twitter.com")==0&&(b.url="http://"+b.text),this.scribeInteraction("open_link",b,c)},this.scribeCardAction=function(a,b,c){c&&c.tweetHasCard&&this.scribeCardInteraction(a,c)},this.after("initialize",function(){this.on(document,"uiHasInjectedNewTimeline",this.handleNewerTimelineItems),this.on(document,"dataProfilePopupSuccess",this.handleProfilePopup),this.on(document,"uiItemSelected",this.scribeItemAction.bind(this,"select")),this.on(document,"uiItemDeselected",this.scribeItemAction.bind(this,"deselect")),this.on(document,"uiHashtagClick uiCashtagClick",this.scribeSearchTagClick),this.on(document,"uiItemLinkClick",this.scribeLinkClick),this.on(document,"uiItemSelected",this.scribeCardAction.bind(this,"show")),this.on(document,"uiItemDeselected",this.scribeCardAction.bind(this,"hide")),this.on(document,"uiMapShow",this.scribeItemAction.bind(this,"show")),this.on(document,"uiMapClick",this.scribeItemAction.bind(this,"click")),this.on(document,"uiShareViaEmailDialogOpened",this.scribeItemAction.bind(this,"open"))})}var defineComponent=require("core/component"),withInteractionDataScribe=require("app/data/with_interaction_data_scribe"),associationTypes=require("app/utils/scribe_association_types"),withCardMetadata=require("app/data/with_card_metadata"),itemTypes=require("app/utils/scribe_item_types");module.exports=defineComponent(itemActionsScribe,withInteractionDataScribe,withCardMetadata)
});
define("app/data/navigation_scribe",["module","require","exports","core/component","app/data/client_event","app/data/with_scribe"],function(module, require, exports) {
function navigationScribe(){this.scribeNav=function(a,b){this.scribe("navigate",b,{url:b.url})},this.scribeCachedImpression=function(a,b){b.fromCache&&this.scribe("impression")},this.setInternalReferer=function(a,b){var c=(window.location.protocol+"//"+window.location.host).length;clientEvent.internalReferer=window.location.href.substring(c)},this.after("initialize",function(){this.on("uiNavigate",this.setInternalReferer),this.on("uiNavigationLinkClick",this.scribeNav),this.on("uiPageChanged",this.scribeCachedImpression)})}var defineComponent=require("core/component"),clientEvent=require("app/data/client_event"),withScribe=require("app/data/with_scribe");module.exports=defineComponent(navigationScribe,withScribe)
});
define("app/boot/scribing",["module","require","exports","app/data/scribe_transport","app/data/scribe_monitor","app/data/client_event","app/data/ddg","app/data/tweet_actions_scribe","app/data/user_actions_scribe","app/data/item_actions_scribe","app/data/navigation_scribe"],function(module, require, exports) {
function initialize(a){var b={useAjax:!0,bufferEvents:!0,flushOnUnload:a.environment!="selenium",metrics:a.scribeMetrics/1e4,bufferSize:a.environment=="selenium"?1e3*a.scribeBufferSize:a.scribeBufferSize,debug:a.environment!="production"};a.useNewScribeEndpoint||(b.url="/scribe"),scribeTransport.updateOptions(b),scribeTransport.registerEventHandlers(),clientEvent.scribeContext={client:"web",page:a.pageName,section:a.sectionName},clientEvent.scribeData={internal_referer:clientEvent.internalReferer||a.internalReferer,client_version:"swift"},delete clientEvent.internalReferer,a.loggedIn||(clientEvent.scribeData.user_id=0),ddg.experiments=a.experiments,(a.scribeMetrics||a.scribesForScribeConsole)&&ScribeMonitor.attachTo(document,{userFraction:(a.scribeMetrics||0)/1e4,scribesForScribeConsole:a.scribesForScribeConsole}),TweetActionsScribe.attachTo(document),UserActionsScribe.attachTo(document),ItemActionsScribe.attachTo(document),NavigationScribe.attachTo(document,a)}var scribeTransport=require("app/data/scribe_transport"),ScribeMonitor=require("app/data/scribe_monitor"),clientEvent=require("app/data/client_event"),ddg=require("app/data/ddg"),TweetActionsScribe=require("app/data/tweet_actions_scribe"),UserActionsScribe=require("app/data/user_actions_scribe"),ItemActionsScribe=require("app/data/item_actions_scribe"),NavigationScribe=require("app/data/navigation_scribe");module.exports=initialize
});
define("app/utils/full_path",["module","require","exports"],function(module, require, exports) {
function fullPath(){return[location.pathname,location.search].join("")}module.exports=fullPath
});
define("app/ui/navigation",["module","require","exports","core/component","core/utils","core/clock","core/registry","app/utils/full_path"],function(module, require, exports) {
function navigation(){this.routes={home:"/",activity:"/activity",connect:"/i/connect",mentions:"/mentions",discover:"/i/discover",profile:"/",favorites:"/favorites",settings:"/settings/account",lists:"/lists"},this.defaultAttrs({spinnerContainer:"body",pushStateSelector:"a.js-nav",pageContainer:"#page-container",docContainer:"#doc",spinnerClass:"pushing-state"}),this.navigate=function(a){var b,c;if(a.shiftKey||a.ctrlKey||a.metaKey||a.which!=undefined&&a.which>1)return;b=$(a.target),c=b.closest(this.attr.pushStateSelector),c.length&&!a.isDefaultPrevented()&&(this.trigger(c,"uiNavigate",{href:c.attr("href")}),a.preventDefault(),a.stopImmediatePropagation())},this.reloadPage=function(){location.reload()},this.updatePage=function(a,b,c){b.init_data.pushState||this.reloadPage(),this.trigger("uiBeforePageChanged",b),this.trigger("uiTeardown",b),$("body").attr("class",b.body_class_names),this.select("docContainer").attr("class",b.doc_class_names),this.select("pageContainer").attr("class",b.page_container_class_names),this.select("pageContainer").html(b.page),b.isPopState||$("html, body").scrollTop(0),using(b.module,function(a){a(b.init_data),this.trigger("uiPageChanged",b)}.bind(this))},this.navigateTo=function(a){return function(){this.trigger("uiNavigate",{href:this.routes[a]})}},this.showSpinner=function(a,b){this.select("spinnerContainer").addClass(this.attr.spinnerClass)},this.hideSpinner=function(a,b){this.select("spinnerContainer").removeClass(this.attr.spinnerClass)},this.onUiNavigate=function(a,b){b.href!=fullPath()&&(location.href=b.href)},this.after("initialize",function(){this.attr.pushState?(this.on("click",this.navigate),this.on("dataPageRefresh",this.updatePage),this.on("dataPageFetch",this.showSpinner),this.on("dataPageRefresh",this.hideSpinner)):this.on("uiNavigate",this.onUiNavigate),this.on("uiShortcutNavigateHome",this.navigateTo("home")),this.on("uiShortcutNavigateActivity",this.navigateTo("activity")),this.on("uiShortcutNavigateConnect",this.navigateTo("connect")),this.on("uiShortcutNavigateMentions",this.navigateTo("mentions")),this.on("uiShortcutNavigateDiscover",this.navigateTo("discover")),this.on("uiShortcutNavigateProfile",this.navigateTo("profile")),this.on("uiShortcutNavigateFavorites",this.navigateTo("favorites")),this.on("uiShortcutNavigateSettings",this.navigateTo("settings")),this.on("uiShortcutNavigateLists",this.navigateTo("lists")),this.attr.routes&&utils.push(this.routes,this.attr.routes)})}var component=require("core/component"),utils=require("core/utils"),clock=require("core/clock"),registry=require("core/registry"),fullPath=require("app/utils/full_path"),Navigation=component(navigation);module.exports=Navigation
});
provide("app/utils/time",function(a){function b(a){this.ms=a}function c(a){var c={seconds:new b(a*1e3),minutes:new b(a*1e3*60),hours:new b(a*1e3*60*60),days:new b(a*1e3*60*60*24)};return c.second=c.seconds,c.minute=c.minutes,c.hour=c.hours,c.day=c.days,c}c.now=function(){return(new Date).getTime()},b.prototype.fromNow=function(){return new Date(c.now()+this.ms)},b.prototype.ago=function(){return new Date(c.now()-this.ms)},b.prototype.getTime=b.prototype.valueOf=function(){return this.ms},a(c)})
define("app/data/navigation",["module","require","exports","core/component","core/utils","app/utils/time","app/utils/full_path"],function(module, require, exports) {
function navigationData(){this.defaultAttrs({pageContainer:"#page-container"});var a,b,c;this.navigate=function(a,b){var d=fullPath();c=b.href;if(b.href==d&&this.pageCache[d])return;this.trigger("dataBeforeNavigate"),this.attr.initialState&&this.createInitialState(),this.getPageData(b.href)},this.sweepPageCache=function(){var a=time.now();for(var b in this.pageCacheTTLs)a>this.pageCacheTTLs[b]&&(delete this.pageCache[b],delete this.pageCacheTTLs[b])},this.getPageData=function(a){var b;this.sweepPageCache(),this.trigger("uiBeforeNewPageLoad"),(b=this.pageCache[a])?(b.fromCache=!0,this.pageDataReceived(a,b)):(this.trigger("dataPageFetch"),$.ajax({url:a,dataType:"json",success:function(b){if(b.init_data&&b.page&&b.module){b.init_data.assetsBasePath!=this.attr.assetsBasePath&&(location.href=a);var d=b.init_data.href;b.href=d,this.cacheState(d,b);if(c!=a)return;this.pageDataReceived(d,b)}else location.href=a}.bind(this),error:function(b){location.href=a}}))},this.updatePageState=function(){var b=this.pageCache[a];b&&(b.page=this.select("pageContainer").html(),b.page.length>this.attr.pushStatePageLimit&&(delete this.pageCache[a],delete this.pageCacheTTLs[a]))},this.pageDataReceived=function(a,c){!b&&a!=fullPath()&&history.pushState({},c.title,a),c.isPopState=b,this.trigger("dataPageRefresh",c)},this.doTeardown=function(b,c){component.teardownAll(),c.href!=a&&this.updatePageState()},this.cacheState=function(a,b){this.pageCache[a]=b,this.pageCacheTTLs[a]=time(b.cache_ttl).seconds.fromNow().getTime()},this.onPopState=function(a){if(this.handledPopstate)return;a.originalEvent.state&&(this.attr.initialState&&!this.handledPopstate&&(this.handledPopstate=!0),b=!0,c=fullPath(),this.getPageData(c))},this.createInitialState=function(){var a=fullPath(),b=utils.merge({},this.attr.initialState,!0);b.page=this.select("pageContainer").html(),b.init_data=utils.merge({},this.attr,!0),delete b.init_data.initialState,this.cacheState(a,b),history.replaceState({},this.title,a)},this.resetPageCache=function(a,b){this.pageCache=pageCache={},this.pageCacheTTLs=pageCacheTTLs={}},this.removePageFromCache=function(a,b){var c=b.href;this.pageCache[c]&&(delete this.pageCache[c],delete this.pageCacheTTLs[c])},this.after("initialize",function(){this.pageCache=pageCache,this.pageCacheTTLs=pageCacheTTLs,this.on(window,"popstate",this.onPopState),this.on("uiNavigate",this.navigate),this.on("uiTeardown",this.doTeardown),this.on(document,"dataPageMutated",this.resetPageCache),this.on(document,"uiPromotedLinkClick",this.removePageFromCache),a=fullPath(),b=!1})}var component=require("core/component"),utils=require("core/utils"),time=require("app/utils/time"),fullPath=require("app/utils/full_path"),NavigationData=component(navigationData),pageCache={},pageCacheTTLs={};module.exports=NavigationData
});
define("app/ui/with_dropdown",["module","require","exports"],function(module, require, exports) {
function withDropdown(){this.toggleDisplay=function(a){this.$node.toggleClass("open"),this.$node.hasClass("open")&&(this.activeEl=document.activeElement,this.trigger("uiDropdownOpened")),a&&a.preventDefault()},this.ignoreCloseEvent=!1,this.closeDropdown=function(){this.$node.removeClass("open")},this.onKeyDown=function(a){a.keyCode==27&&(this.closeDropdown(),this.activeEl&&(this.activeEl.focus(),this.activeEl=null))},this.close=function(a){var b=$(this.attr.toggler);if((a.target===this.$node||this.$node.has(a.target).length>0)&&!this.isItemClick(a))return;if(this.isItemClick(a)&&this.ignoreCloseEvent)return;this.closeDropdown()},this.isItemClick=function(a){return!this.attr.itemSelector||!a?!1:$(a.target).closest(this.attr.itemSelector).length>0},this.after("initialize",function(){this.on(this.attr.toggler,"click",this.toggleDisplay),this.on(document,"click",this.close),this.on(document,"uiCloseDropdowns uiNavigate",this.closeDropdown),this.on(document,"keydown",this.onKeyDown)})}module.exports=withDropdown
});
define("app/ui/language_dropdown",["module","require","exports","core/component","app/ui/with_dropdown"],function(module, require, exports) {
function languageDropdown(){this.defaultAttrs({toggler:".dropdown-toggle"})}var defineComponent=require("core/component"),withDropdown=require("app/ui/with_dropdown"),LanguageDropdown=defineComponent(languageDropdown,withDropdown);module.exports=LanguageDropdown
});
define("app/ui/google",["module","require","exports","core/component"],function(module, require, exports) {
function googleAnalytics(){this.defaultAttrs({gaPageName:window.location.pathname}),this.initGoogle=function(){window._gaq=window._gaq||[],window._gaq.push(["_setAccount","UA-30775-6"],["_trackPageview",this.attr.gaPageName],["_setDomainName","twitter.com"]);var a=document.getElementsByTagName("script")[0],b=document.createElement("script");b.async=!0,b.src=(document.location.protocol=="https:"?"https://ssl":"http://www")+".google-analytics.com/ga.js",a.parentNode.insertBefore(b,a),this.off("uiSwiftLoaded",this.initGoogle)},this.trackPageChange=function(a,b){b=b.init_data,window._gaq.push(["_trackPageview",b&&b.gaPageName||window.location.pathname])},this.after("initialize",function(){this.on("uiSwiftLoaded",this.initGoogle),this.on("uiPageChanged",this.trackPageChange)})}var defineComponent=require("core/component"),GoogleAnalytics=defineComponent(googleAnalytics);module.exports=GoogleAnalytics
});
define("app/utils/cookie",["module","require","exports"],function(module, require, exports) {
module.exports=function(b,c,d){var e=$.extend({},d);if(arguments.length>1&&String(c)!=="[object Object]"){if(c===null||c===undefined)e.expires=-1,c="";if(typeof e.expires=="number"){var f=e.expires,g=new Date((new Date).getTime()+f*24*60*60*1e3);e.expires=g}return c=String(c),document.cookie=[encodeURIComponent(b),"=",e.raw?c:encodeURIComponent(c),e.expires?"; expires="+e.expires.toUTCString():"","; path="+(e.path||"/"),e.domain?"; domain="+e.domain:"",e.secure?"; secure":""].join("")}e=c||{};var h,i=e.raw?function(a){return a}:decodeURIComponent;return(h=(new RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)")).exec(document.cookie))?i(h[1]):null}
});
define("app/ui/impression_cookies",["module","require","exports","core/component","app/utils/cookie"],function(module, require, exports) {
function impressionCookies(){this.defaultAttrs({sendImpressionCookieSelector:"a[data-send-impression-cookie]",link:"a"}),this.setCookie=function(a,b){cookie("ic",a,{expires:b})},this.sendImpressionCookie=function(a,b){var c=b.el;if(!c||c.hostname!=window.location.hostname||!c.pathname||c.pathname.indexOf("/#!/")==0)return;var d=$(c),e=d.closest("[data-impression-cookie]").attr("data-impression-cookie");if(!e)return;this.trigger("uiPromotedLinkClick",{href:d.attr("href")});var f=new Date,g=6e4,h=new Date(f.getTime()+g);this.setCookie(e,h)},this.after("initialize",function(a){this.on("click",{sendImpressionCookieSelector:this.sendImpressionCookie}),this.on("uiShowProfileNewWindow",{link:this.sendImpressionCookie})})}var defineComponent=require("core/component"),cookie=require("app/utils/cookie");module.exports=defineComponent(impressionCookies)
});
define("app/data/with_auth_token",["module","require","exports","app/utils/auth_token","core/utils"],function(module, require, exports) {
function withAuthToken(){this.addAuthToken=function(b){if(!authToken.get())throw"addAuthToken requires a formAuthenticityToken";return b=b||{},utils.merge(b,{authenticity_token:authToken.get()})},this.addPHXAuthToken=function(b){if(!authToken.get())throw"addPHXAuthToken requires a formAuthenticityToken";return b=b||{},utils.merge(b,{post_authenticity_token:authToken.get()})},this.getAuthToken=function(){return this.attr.formAuthenticityToken}}var authToken=require("app/utils/auth_token"),utils=require("core/utils");module.exports=withAuthToken
});
define("app/data/with_data",["module","require","exports","core/compose","core/i18n","app/data/with_auth_token"],function(module, require, exports) {
function withData(){compose.mixin(this,[withAuthToken]);var a=[];this.createSuccessHandler=function(b,c){return function(d,e,f){a.slice(a.indexOf(f),1),d=d||{},d.sourceEventData=c,typeof b=="function"?b(d):this.trigger(b,d),d.debug&&this.trigger("dataSetDebugData",d.debug)}.bind(this)},this.createErrorHandler=function(b,c){return function(d){a.slice(a.indexOf(d),1);var e;try{e=JSON.parse(d.responseText),e&&e.message&&!this.attr.noShowError&&this.trigger("uiShowError",e)}catch(f){e={xhr:{}},d&&d.statusText&&(e.xhr.statusText=d.statusText)}e.message||(e.message=_('Internal server error.')),e.sourceEventData=c,typeof b=="function"?b(e):this.trigger(b,e)}.bind(this)},this.sortData=function(a){if(!a||typeof a!="object")return a;var b={},c=Object.keys(a).sort();return c.forEach(function(c){b[c]=a[c]}),b},this.JSONRequest=function(b,c){var d=c=="POST"||c=="DELETE";d&&b.isMutation===!1&&(d=!1),this.trigger&&d&&this.trigger("dataPageMutated"),["url","eventData","data","success","error"].forEach(function(a){if(!b.hasOwnProperty(a))throw new Error("getJSONRequest called without required option: "+a,arguments)});var e=b.data,f=b.headers;["GET","POST"].indexOf(c)<0&&(e=$.extend({_method:c},e),c="POST"),c=="POST"&&(e=this.addAuthToken(e),f&&f["X-PHX"]&&(e=this.addPHXAuthToken(e)));var g=window.location.search.match(/[?&]lang=([^&]+)/);g&&(e=$.extend({lang:decodeURIComponent(g)},e));var h=$.ajax($.extend(b,{url:b.url,data:this.sortData(e),dataType:"json",type:c,success:this.createSuccessHandler(b.success,b.eventData),error:this.createErrorHandler(b.error,b.eventData)}));return b.noAbortOnNavigate||a.push(h),h},this.get=function(a){return this.JSONRequest(a,"GET")},this.post=function(a){return this.JSONRequest(a,"POST")},this.destroy=function(a){return this.JSONRequest(a,"DELETE")},this.abortAllXHR=function(){a.forEach(function(a){a&&a.abort&&a.abort()}),a=[]},this.after("initialize",function(){this.on(document,"dataBeforeNavigate",this.abortAllXHR)})}var compose=require("core/compose"),_=require("core/i18n"),withAuthToken=require("app/data/with_auth_token");module.exports=withData
});
define("app/data/promoted_logger",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function promotedLogger(){this.defaultAttrs({tweetHashtagLinkSelector:".tweet .twitter-hashtag",tweetLinkSelector:".tweet .twitter-timeline-link"}),this.logEvent=function(a,b){this.get({url:"/i/promoted_content/log.json",data:a,eventData:{},headers:{"X-PHX":!0},success:"dataLogEventSuccess",error:"dataLogEventError",async:!b,noAbortOnNavigate:!0})},this.isEarnedMedia=function(a){return a=="earned"},this.logPromotedTrendImpression=function(a,b){var c=b.items,d=b.source;if(d=="clock")return;var e=c.filter(function(a){return!!a.promotedTrendId});if(!e.length)return;this.logEvent({event:"i",promoted_trend_id:e[0].promotedTrendId})},this.logPromotedTrendClick=function(a,b){if(!b.promotedTrendId)return;this.logEvent({event:"c",promoted_trend_id:b.promotedTrendId},!0)},this.logPromotedTweetImpression=function(a,b){var c=b.tweets.filter(function(a){return a.impressionId});c.forEach(function(a){this.logEvent({event:"impression",impression_id:a.impressionId,earned:this.isEarnedMedia(a.disclosureType)})}.bind(this))},this.logPromotedTweetLinkClick=function(a){var b=$(a.target).closest("[data-impression-id]").attr("data-impression-id"),c=$(a.target).closest("[data-impression-id]").attr("data-disclosure-type");if(!b)return;this.logEvent({event:"url_click",impression_id:b,earned:this.isEarnedMedia(c)},!0)},this.logPromotedTweetHashtagClick=function(a){var b=$(a.target).closest("[data-impression-id]").attr("data-impression-id"),c=$(a.target).closest("[data-impression-id]").attr("data-disclosure-type");if(!b)return;this.logEvent({event:"hashtag_click",impression_id:b,earned:this.isEarnedMedia(c)},!0)},this.logPromotedUserImpression=function(a,b){var c=b.users.filter(function(a){return a.impressionId});c.forEach(function(a){this.logEvent({event:"impression",impression_id:a.impressionId})}.bind(this))},this.logPromotedUserClick=function(a,b){var c=b.impressionId;if(!c)return;var d=this.isEarnedMedia(b.disclosureType);b.profileClickTarget==="avatar"?this.logEvent({event:"profile_image_click",impression_id:c,earned:d}):b.isMentionClick?this.logEvent({event:"user_mention_click",impression_id:c,earned:d}):b.isPromotedBadgeClick?this.logEvent({event:"footer_profile",impression_id:c,earned:d}):this.logEvent({event:"screen_name_click",impression_id:c,earned:d})},this.logPromotedUserDismiss=function(a,b){var c=b.impressionId;if(!c)return;this.logEvent({event:"dismiss",impression_id:c})},this.logPromotedTweetDismiss=function(a,b){var c=b.impressionId,d=b.disclosureType;if(!c)return;this.logEvent({event:"dismiss",impression_id:c,earned:this.isEarnedMedia(d)})},this.logPromotedTweetDetails=function(a,b){var c=b.impressionId,d=b.disclosureType;if(!c)return;this.logEvent({event:"view_details",impression_id:c,earned:this.isEarnedMedia(d)})},this.after("initialize",function(){this.on("uiTrendsDisplayed",this.logPromotedTrendImpression),this.on("uiTrendSelected",this.logPromotedTrendClick),this.on("uiTweetsDisplayed",this.logPromotedTweetImpression),this.on("click",{tweetLinkSelector:this.logPromotedTweetLinkClick,tweetHashtagLinkSelector:this.logPromotedTweetHashtagClick}),this.on("uiHasExpandedTweet",this.logPromotedTweetDetails),this.on("uiTweetDismissed",this.logPromotedTweetDismiss),this.on("uiUsersDisplayed",this.logPromotedUserImpression),this.on("uiDismissUserRecommendation",this.logPromotedUserDismiss),this.on("uiShowProfilePopup uiShowProfileNewWindow",this.logPromotedUserClick)})}var defineComponent=require("core/component"),withData=require("app/data/with_data"),PromotedLogger=defineComponent(promotedLogger,withData);module.exports=PromotedLogger
});
define("app/ui/message_drawer",["module","require","exports","core/component"],function(module, require, exports) {
function messageDrawer(){this.defaultAttrs({fadeTimeout:2e3,closeSelector:".dismiss",textSelector:".message-text",bannersSelector:"#banners",topOffset:47});var a=function(){this.$node.css("opacity",1).animate({opacity:0},1e3,function(){this.closeMessage()}.bind(this))};this.showMessage=function(b,c){this.$node.css({opacity:1,top:this.attr.topOffset+$(this.attr.bannersSelector).height()}),this.select("textSelector").html(c.message),this.select("closeSelector").hide(),this.$node.removeClass("hidden"),clearTimeout(this.messageTimeout),this.$node.stop(),this.messageTimeout=setTimeout(a.bind(this),this.attr.fadeTimeout)},this.showError=function(a,b){this.$node.css("opacity",1),this.select("textSelector").html(b.message),this.select("closeSelector").show(),this.$node.removeClass("hidden")},this.closeMessage=function(a){a&&a.preventDefault(),this.$node.addClass("hidden")},this.after("initialize",function(){this.on(document,"uiShowMessage",this.showMessage),this.on(document,"uiShowError",this.showError),this.on(this.attr.closeSelector,"click",this.closeMessage),this.on(document,"uiBeforePageChanged",this.closeMessage)})}var defineComponent=require("core/component"),MessageDrawer=defineComponent(messageDrawer);module.exports=MessageDrawer
});
deferred('$lib/bootstrap_tooltip.js', function() {
/*! bootstrap-tooltip.js v2.0.2 (c) 2012 Twitter, Inc. http://www.apache.org/licenses/LICENSE-2.0 */!function($){"use strict";var a=function(a,b){this.init("tooltip",a,b)};a.prototype={constructor:a,init:function(a,b,c){var d,e;this.type=a,this.$element=$(b),this.options=this.getOptions(c),this.enabled=!0,this.options.trigger!="manual"&&(d=this.options.trigger=="hover"?"mouseenter":"focus",e=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(d,this.options.selector,$.proxy(this.enter,this)),this.$element.on(e,this.options.selector,$.proxy(this.leave,this))),this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(a){return a=$.extend({},$.fn[this.type].defaults,a,this.$element.data()),a.delay&&typeof a.delay=="number"&&(a.delay={show:a.delay,hide:a.delay}),a},enter:function(a){var b=$(a.currentTarget)[this.type](this._options).data(this.type);!b.options.delay||!b.options.delay.show?b.show():(b.hoverState="in",setTimeout(function(){b.hoverState=="in"&&b.show()},b.options.delay.show))},leave:function(a){var b=$(a.currentTarget)[this.type](this._options).data(this.type);!b.options.delay||!b.options.delay.hide?b.hide():(b.hoverState="out",setTimeout(function(){b.hoverState=="out"&&b.hide()},b.options.delay.hide))},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){a=this.tip(),this.setContent(),this.options.animation&&a.addClass("fade"),f=typeof this.options.placement=="function"?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/in/.test(f),a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight;switch(b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g).addClass(f).addClass("in")}},setContent:function(){var a=this.tip();a.find(".tooltip-inner").html(this.getTitle()),a.removeClass("fade in top bottom left right")},hide:function(){function c(){var a=setTimeout(function(){b.off($.support.transition.end).remove()},500);b.one($.support.transition.end,function(){clearTimeout(a),b.remove()})}var a=this,b=this.tip();b.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?c():b.remove()},fixTitle:function(){var a=this.$element;(a.attr("title")||typeof a.attr("data-original-title")!="string")&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(a){return $.extend({},a?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||(typeof c.title=="function"?c.title.call(b[0]):c.title),a=(a||"").toString().replace(/(^\s*|\s*$)/,""),a},tip:function(){return this.$tip=this.$tip||$(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},$.fn.tooltip=function(b){return this.each(function(){var c=$(this),d=c.data("tooltip"),e=typeof b=="object"&&b;d||c.data("tooltip",d=new a(this,e)),typeof b=="string"&&d[b]()})},$.fn.tooltip.Constructor=a,$.fn.tooltip.defaults={animation:!0,delay:0,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'}}(window.jQuery)
});
define("app/ui/tooltips",["module","require","exports","core/component","$lib/bootstrap_tooltip.js"],function(module, require, exports) {
function tooltips(){this.defaultAttrs({tooltipSelector:".js-tooltip"}),this.hide=function(){this.select("tooltipSelector").tooltip("hide")},this.after("initialize",function(){this.$node.tooltip({selector:this.attr.tooltipSelector}),this.on(document,"uiBeforePageChanged",this.hide)})}var defineComponent=require("core/component");require("$lib/bootstrap_tooltip.js"),module.exports=defineComponent(tooltips)
});
define("app/boot/common",["module","require","exports","app/utils/params","app/utils/auth_token","app/boot/scribing","app/ui/navigation","app/data/navigation","app/ui/language_dropdown","app/ui/google","app/ui/impression_cookies","app/data/promoted_logger","app/ui/message_drawer","app/ui/tooltips","app/utils/cookie","app/utils/querystring"],function(module, require, exports) {
function shimConsole(a){window.console||(window.console={}),LOG_METHODS.forEach(function(b){if(a||!console[b])console[b]=NO_OP})}function getLoginTime(){return parseInt(querystring.decode(cookie("twll")).l,10)||0}function verifySession(){getLoginTime()!==initialLoginTime&&window.location.reload(!0)}var params=require("app/utils/params"),authToken=require("app/utils/auth_token"),scribing=require("app/boot/scribing"),Navigation=require("app/ui/navigation"),NavigationData=require("app/data/navigation"),LanguageDropdown=require("app/ui/language_dropdown"),GoogleAnalytics=require("app/ui/google"),ImpressionCookies=require("app/ui/impression_cookies"),PromotedLogger=require("app/data/promoted_logger"),MessageDrawer=require("app/ui/message_drawer"),Tooltips=require("app/ui/tooltips"),cookie=require("app/utils/cookie"),querystring=require("app/utils/querystring"),LOG_METHODS=["log","warn","debug","info"],NO_OP=function(){},initialLoginTime=0;module.exports=function(b){var c=b.environment,d=["production","preflight"].indexOf(c)>-1;shimConsole(d),authToken.set(b.formAuthenticityToken),ImpressionCookies.attachTo(document),GoogleAnalytics.attachTo(document),scribing(b),PromotedLogger.attachTo(document);var e=b.pushState&&window.history&&history.pushState;Navigation.attachTo(document,{pushState:e,routes:b.routes}),e&&NavigationData.attachTo(document,b),Tooltips.attachTo(document),MessageDrawer.attachTo("#message-drawer"),b.loggedIn||LanguageDropdown.attachTo(".js-language-dropdown"),b.loggedIn&&(initialLoginTime=getLoginTime(),setInterval(verifySession,1e4))}
});
define("app/ui/with_position",["module","require","exports"],function(module, require, exports) {
function Position(){this.adjacent=function(a,b,c){var d,e;c=c||{},d=e=b.offset(),e.gravity=c.gravity,e.weight=c.weight;var f={height:b.outerHeight(),width:b.outerWidth()},g={height:a.outerHeight(),width:a.outerWidth()},h={height:$(window).height(),width:$(window).width()},i={height:$("body").height(),width:$("body").width()};return e.gravity||(e.gravity="vertical"),"vertical,north,south".indexOf(e.gravity)!=-1&&("right,left,center".indexOf(e.weight)==-1&&(e.weight=d.left>h.width/2?"right":"left"),e.gravity=="vertical"&&(e.gravity=d.top+g.height>$(window).scrollTop()+h.height?"south":"north"),c.position=="relative"&&(d={left:0,top:0},e.left=0),e.weight=="right"?e.left=d.left-g.width+f.width:e.weight=="center"&&(e.left=d.left-(g.width-f.width)/2),e.top=e.gravity=="north"?d.top+f.height:d.top-g.height),"horizontal,east,west".indexOf(e.gravity)!=-1&&("top,bottom,center".indexOf(e.weight)==-1&&(d.top-g.height/2<0?e.weight="top":d.top+g.height/2>Math.max(h.height,i.height)?e.weight="bottom":e.weight="center"),e.gravity=="horizontal"&&(e.gravity=d.left+f.width/2>h.width/2?"east":"west"),c.position=="relative"&&(d={left:0,top:0},e.top=0),e.weight=="center"?e.top=d.top+f.height/2-g.height/2:e.weight=="bottom"&&(e.top=d.top-g.height+f.height),e.left=e.gravity=="west"?d.left+f.width:d.left-g.width),e}}module.exports=Position
});
define("app/ui/with_scrollbar_width",["module","require","exports"],function(module, require, exports) {
function ScrollbarWidth(){this.calculateScrollbarWidth=function(){if($("#scrollbar-width").length>0)return;var a=$('<div class="modal-measure-scrollbar"/>').prependTo($("body")),b=$('<div class="inner"/>').appendTo(a),c=a.width()-b.width();a.remove(),$("head").append('<style id="scrollbar-width">        .modal-enabled,        .modal-enabled .global-nav-inner,        .gallery-enabled,        .gallery-enabled .global-nav-inner {          margin-right: '+c+"px      } </style>")}}module.exports=ScrollbarWidth
});
deferred('$lib/jquery.event.drag.js', function() {
/*! jquery.event.drag (c) 2010 Three Dub Media - http://threedubmedia.com http://threedubmedia.com/code/license */(function($){$.fn.drag=function(a,b,c){var d=typeof a=="string"?a:"",e=$.isFunction(a)?a:$.isFunction(b)?b:null;return d.indexOf("drag")!==0&&(d="drag"+d),c=(a==e?b:c)||{},e?this.bind(d,c,e):this.trigger(d)};var a=$.event,b=a.special,c=b.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",livekey:"livedrag",add:function(b){var d=$.data(this,c.datakey),e=b.data||{};d.related+=1,!d.live&&b.selector&&(d.live=!0,a.add(this,"draginit."+c.livekey,c.delegate)),$.each(c.defaults,function(a,b){e[a]!==undefined&&(d[a]=e[a])})},remove:function(){$.data(this,c.datakey).related-=1},setup:function(){if($.data(this,c.datakey))return;var b=$.extend({related:0},c.defaults);$.data(this,c.datakey,b),a.add(this,"mousedown",c.init,b),this.attachEvent&&this.attachEvent("ondragstart",c.dontstart)},teardown:function(){if($.data(this,c.datakey).related)return;$.removeData(this,c.datakey),a.remove(this,"mousedown",c.init),a.remove(this,"draginit",c.delegate),c.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",c.dontstart)},init:function(d){var e=d.data,f;if(e.which>0&&d.which!=e.which)return;if($(d.target).is(e.not))return;if(e.handle&&!$(d.target).closest(e.handle,d.currentTarget).length)return;e.propagates=1,e.interactions=[c.interaction(this,e)],e.target=d.target,e.pageX=d.pageX,e.pageY=d.pageY,e.dragging=null,f=c.hijack(d,"draginit",e);if(!e.propagates)return;return f=c.flatten(f),f&&f.length&&(e.interactions=[],$.each(f,function(){e.interactions.push(c.interaction(this,e))})),e.propagates=e.interactions.length,e.drop!==!1&&b.drop&&b.drop.handler(d,e),c.textselect(!1),a.add(document,"mousemove mouseup",c.handler,e),!1},interaction:function(a,b){return{drag:a,callback:new c.callback,droppable:[],offset:$(a)[b.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(d){var e=d.data;switch(d.type){case!e.dragging&&"mousemove":if(Math.pow(d.pageX-e.pageX,2)+Math.pow(d.pageY-e.pageY,2)<Math.pow(e.distance,2))break;d.target=e.target,c.hijack(d,"dragstart",e),e.propagates&&(e.dragging=!0);case"mousemove":if(e.dragging){c.hijack(d,"drag",e);if(e.propagates){e.drop!==!1&&b.drop&&b.drop.handler(d,e);break}d.type="mouseup"};case"mouseup":a.remove(document,"mousemove mouseup",c.handler),e.dragging&&(e.drop!==!1&&b.drop&&b.drop.handler(d,e),c.hijack(d,"dragend",e)),c.textselect(!0),e.click===!1&&e.dragging&&($.event.triggered=!0,setTimeout(function(){$.event.triggered=!1},20),e.dragging=!1)}},delegate:function(b){var d=[],e,f=$.data(this,"events")||{};return $.each(f.live||[],function(f,g){if(g.preType.indexOf("drag")!==0)return;e=$(b.target).closest(g.selector,b.currentTarget)[0];if(!e)return;a.add(e,g.origType+"."+c.livekey,g.origHandler,g.data),$.inArray(e,d)<0&&d.push(e)}),d.length?$(d).bind("dragend."+c.livekey,function(){a.remove(this,"."+c.livekey)}):!1},hijack:function(b,d,e,f,g){if(!e)return;var h={event:b.originalEvent,type:b.type},i=d.indexOf("drop")?"drag":"drop",j,k=f||0,l,m,n,o=isNaN(f)?e.interactions.length:f;b.type=d,b.originalEvent=null,e.results=[];do if(l=e.interactions[k]){if(d!=="dragend"&&l.cancelled)continue;n=c.properties(b,e,l),l.results=[],$(g||l[i]||e.droppable).each(function(f,g){n.target=g,j=g?a.handle.call(g,b,n):null,j===!1?(i=="drag"&&(l.cancelled=!0,e.propagates-=1),d=="drop"&&(l[i][f]=null)):d=="dropinit"&&l.droppable.push(c.element(j)||g),d=="dragstart"&&(l.proxy=$(c.element(j)||l.drag)[0]),l.results.push(j),delete b.result;if(d!=="dropinit")return j}),e.results[k]=c.flatten(l.results),d=="dropinit"&&(l.droppable=c.flatten(l.droppable)),d=="dragstart"&&!l.cancelled&&n.update()}while(++k<o);return b.type=h.type,b.originalEvent=h.event,c.flatten(e.results)},properties:function(a,b,d){var e=d.callback;return e.drag=d.drag,e.proxy=d.proxy||d.drag,e.startX=b.pageX,e.startY=b.pageY,e.deltaX=a.pageX-b.pageX,e.deltaY=a.pageY-b.pageY,e.originalX=d.offset.left,e.originalY=d.offset.top,e.offsetX=a.pageX-(b.pageX-e.originalX),e.offsetY=a.pageY-(b.pageY-e.originalY),e.drop=c.flatten((d.drop||[]).slice()),e.available=c.flatten((d.droppable||[]).slice()),e},element:function(a){if(a&&(a.jquery||a.nodeType==1))return a},flatten:function(a){return $.map(a,function(a){return a&&a.jquery?$.makeArray(a):a&&a.length?c.flatten(a):a})},textselect:function(a){$(document)[a?"unbind":"bind"]("selectstart",c.dontstart).attr("unselectable",a?"off":"on").css("MozUserSelect",a?"":"none")},dontstart:function(){return!1},callback:function(){}};c.callback.prototype={update:function(){b.drop&&this.available.length&&$.each(this.available,function(a){b.drop.locate(this,a)})}},b.draginit=b.dragstart=b.dragend=c})(jQuery)
});
define("app/ui/with_dialog",["module","require","exports","core/compose","app/ui/with_scrollbar_width","$lib/jquery.event.drag.js"],function(module, require, exports) {
function withDialog(){compose.mixin(this,[withScrollbarWidth]),this.center=function(a){var b=$(window),c={top:parseInt((b.height()-a.outerHeight())/2),left:parseInt((b.width()-a.outerWidth())/2)};return $("body.ie6").length&&(c.top+=b.scrollTop(),c.left+=b.scrollLeft()),c},this.windowHeight=function(){return $(window).height()},this.scrollTop=function(){return $(window).scrollTop()},this.position=function(){var a=this.center(this.$dialog);this.attr.top&&(a.top=this.attr.top),this.attr.left&&(a.left=this.attr.left),this.attr.maxTop&&(a.top=Math.min(a.top,this.attr.maxTop)),this.attr.maxLeft&&(a.left=Math.min(a.left,this.attr.maxLeft)),$("body").attr("dir")==="rtl"?this.$dialog.css({top:a.top,right:a.left}):this.$dialog.css({top:a.top,left:a.left}),this.windowHeight()<this.$dialog.outerHeight()?(this.$dialog.css("position","absolute"),this.$dialog.css("top",this.scrollTop()+"px")):this.attr.fixed===!1&&this.$dialog.css("top",a.top+this.scrollTop())},this.resize=function(){this.attr.width&&this.$dialog.css("width",this.attr.width),this.attr.height&&this.$dialog.css("height",this.attr.height)},this.applyDraggability=function(){if(!this.$dialog.hasClass("draggable"))return;var a=this,b={relative:!0,handle:".modal-header"},c=function(a,b){$("body").attr("dir")==="rtl"?this.$dialog.css({top:b.offsetY,right:b.originalX-b.deltaX}):this.$dialog.css({top:b.offsetY,left:b.offsetX})};this.$dialog.drag("start",function(){a.$dialog.addClass("unselectable"),$("#doc").addClass("unselectable")}),this.$dialog.drag("end",function(){a.$dialog.removeClass("unselectable"),$("#doc").removeClass("unselectable")}),this.$dialog.drag(c.bind(this),b)},this.setFocus=function(){var a=this.$dialog.find(".primary-btn");a.length&&!a.attr("disabled")&&a.focus()},this.isOpen=function(){return this.$dialogContainer.is(":visible")},this.dialogVisible=function(){this.trigger("uiDialogFadeInComplete")},this.open=function(){this.isOpen()||(this.$dialogContainer.fadeIn("fast",this.dialogVisible.bind(this)),this.calculateScrollbarWidth(),$("body").addClass("modal-enabled"),this.resize(),this.position(),this.applyDraggability(),this.setFocus(),this.trigger("uiDialogOpened"))},this.afterClose=function(){$(".modal-container:visible").length||$("body").removeClass("modal-enabled"),this.trigger("uiDialogHidden")},this.closeRequested=function(a){this.trigger("uiDialogCloseRequested"),this.close(a)},this.close=function(a){if(!this.isOpen())return;a&&a.preventDefault(),this.$dialogContainer.fadeOut("fast",this.afterClose.bind(this)),this.trigger("uiDialogClosed")},this.triggerClicked=function(a){a.preventDefault(),this.open()},this.after("initialize",function(){this.$dialogContainer=this.$dialog||this.$node,this.$dialog=this.$dialogContainer.find("div.modal"),this.attr.closeSelector=this.attr.closeSelector||".modal-close, .close-modal-background-target",this.on(this.select("closeSelector"),"click",this.closeRequested),this.on(document,"uiShortcutEsc",this.closeRequested),this.on(document,"uiCloseDialog",this.closeRequested),this.on(document,"uiBeforePageChanged",this.close),this.attr.triggerSelector&&this.on(this.attr.triggerSelector,"click",this.triggerClicked)})}var compose=require("core/compose"),withScrollbarWidth=require("app/ui/with_scrollbar_width");require("$lib/jquery.event.drag.js"),module.exports=withDialog
});
define("app/ui/dialogs/signin_or_signup",["module","require","exports","core/component","app/ui/with_position","app/ui/with_dialog"],function(module, require, exports) {
function signinOrSignupDialog(){this.defaultAttrs({dialogSelector:"#signin-or-signup"}),this.openSigninDialog=function(a,b){b.signUpOnly?(this.$node.addClass("signup-only-dialog"),this.select("dialogSelector").addClass("signup-only").removeClass("not-signup-only")):(this.$node.removeClass("signup-only-dialog"),this.select("dialogSelector").addClass("not-signup-only").removeClass("signup-only")),this.open(),this.trigger("uiSigninOrSignupDialogOpened")},this.notifyClosed=function(){this.trigger("uiSigninOrSignupDialogClosed")},this.after("initialize",function(a){this.$dialog=this.select("dialogSelector"),this.$dialog.find("form.signup").bind("submit",function(){this.trigger("uiSignupButtonClicked")}.bind(this)),this.on(document,"uiOpenSigninOrSignupDialog",this.openSigninDialog),this.on(document,"uiCloseSigninOrSignupDialog",this.close),this.on(this.$node,"uiDialogClosed",this.notifyClosed)})}var defineComponent=require("core/component"),withPosition=require("app/ui/with_position"),withDialog=require("app/ui/with_dialog"),SigninOrSignupDialog=defineComponent(signinOrSignupDialog,withDialog,withPosition);module.exports=SigninOrSignupDialog
});
define("app/ui/forms/input_with_placeholder",["module","require","exports","core/component"],function(module, require, exports) {
function inputWithPlaceholder(){this.defaultAttrs({hidePlaceholderClassName:"hasome",placeholder:".holder",elementType:"input"}),this.focusInput=function(a){this.$input.focus()},this.inputBlurred=function(a){this.$input.val()==""&&this.$node.removeClass(this.attr.hidePlaceholderClassName)},this.inputChanged=function(a){this.$node.addClass(this.attr.hidePlaceholderClassName)},this.after("initialize",function(){this.$input=this.$node.find(this.attr.elementType);if(this.$input.length!=1)throw new Error("InputWithPlaceholder must be attached to a container with exactly one input element inside of it");this.$placeholder=this.select("placeholder");if(this.$placeholder.length!=1)throw new Error("InputWithPlaceholder must be attached to a container with exactly one placeholder element inside of it");this.on(this.$input,"blur",this.inputBlurred),this.on(this.$input,"keydown paste",this.inputChanged),this.on(this.$placeholder,"click",this.focusInput),this.$input.val()&&this.inputChanged()})}var defineComponent=require("core/component"),InputWithPlaceholder=defineComponent(inputWithPlaceholder);module.exports=InputWithPlaceholder
});
define("app/ui/signup_call_out",["module","require","exports","core/component"],function(module, require, exports) {
function signupCallOut(){this.after("initialize",function(){this.$node.bind("submit",function(){this.trigger("uiSignupButtonClicked")}.bind(this))})}var defineComponent=require("core/component"),SignupCallOut=defineComponent(signupCallOut);module.exports=SignupCallOut
});
define("app/data/signup_click_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function loggedOutScribe(){this.scribeSignupClick=function(a,b){this.scribe({action:"signup_click"},b)},this.scribeSigninOrSignupDialogOpened=function(a,b){this.scribe({action:"open"},b)},this.scribeSigninOrSignupDialogClosed=function(a,b){this.scribe({action:"close"},b)},this.after("initialize",function(){this.on("uiSignupButtonClicked",this.scribeSignupClick),this.on("uiSigninOrSignupDialogOpened",this.scribeSigninOrSignupDialogOpened),this.on("uiSigninOrSignupDialogClosed",this.scribeSigninOrSignupDialogClosed)})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe");module.exports=defineComponent(loggedOutScribe,withScribe)
});
define("app/boot/logged_out",["module","require","exports","app/ui/dialogs/signin_or_signup","app/ui/forms/input_with_placeholder","app/ui/signup_call_out","app/data/signup_click_scribe"],function(module, require, exports) {
var SigninOrSignupDialog=require("app/ui/dialogs/signin_or_signup"),InputWithPlaceholder=require("app/ui/forms/input_with_placeholder"),SignupCallOut=require("app/ui/signup_call_out"),LoggedOutScribe=require("app/data/signup_click_scribe");module.exports=function(b){InputWithPlaceholder.attachTo("#signin-or-signup-dialog .holding, .profile-signup-call-out .holding, .search-signup-call-out .holding"),SigninOrSignupDialog.attachTo("#signin-or-signup-dialog",{eventData:{scribeContext:{component:"auth_dialog",element:"unauth_follow"}}}),SignupCallOut.attachTo(".signup-call-out form.signup",{eventData:{scribeContext:{component:"signup_callout",element:"form"}}}),LoggedOutScribe.attachTo(document)}
});
define("app/utils/ttft",["module","require","exports","app/data/scribe_transport"],function(module, require, exports) {
function scribeTTFTData(a,b){if(!recorded&&window.performance&&a){recorded=!0;var c=a;c.did_load=b,c.web_timings=$.extend({},window.performance.timing),c.web_timings.toJSON&&delete c.web_timings.toJSON,c.navigation={type:window.performance.navigation.type,redirectCount:window.performance.navigation.redirectCount},c.referrer=document.referrer,scribeTransport.send(c,"swift_time_to_first_tweet",!1),using("app/utils/params",function(a){if(a.fromQuery(window.location).show_ttft){var b=c.web_timings;$(document).trigger("uiShowError",{message:"<table width=80%><thead><th>milestone<th>time<th>cumulative</thead><tbody><tr><td>connect:       <td>"+(b.connectEnd-b.navigationStart)+"<td>"+(b.connectEnd-b.navigationStart)+"</tr>"+"<tr><td>process:       <td>"+(b.responseStart-b.connectEnd)+"<td>"+(b.responseStart-b.navigationStart)+"</tr>"+"<tr><td>response:      <td>"+(b.responseEnd-b.responseStart)+"<td>"+(b.responseEnd-b.navigationStart)+"</tr>"+"<tr><td>render:        <td>"+(c.client_record_time-b.responseEnd)+"<td>"+(c.client_record_time-b.navigationStart)+"</tr>"+"<tr><td>interactivity: <td>"+(c.aq_empty_time-c.client_record_time)+"<td>"+(c.aq_empty_time-b.navigationStart)+"</tr>"+"<tr><td>ajax_complete: <td>"+(c.ajax_complete_time-c.aq_empty_time)+"<td>"+(c.ajax_complete_time-b.navigationStart)+"</tr>"+"<tr><td>ajax_count:    <td>"+c.ajax_count+"</tr>"+"</tbody></table>"})}});try{delete window.ttft}catch(d){window.ttft=undefined}}}function scribeMilestones(a){if(!window.ttftData)return;var b=!0;for(var c=0;c<requiredMilestones.length;++c)if(!(requiredMilestones[c]in window.ttftData)){b=!1;break}(a||b)&&scribeTTFTData(window.ttftData,b)}function onAjaxComplete(a,b,c){if(c&&c.url in newAjaxRequests)for(var d=0;d<newAjaxRequests[c.url].length;d++)if(c===newAjaxRequests[c.url][d]){newAjaxRequests[c.url].splice(d,1);return}pendingAjaxCount--;if(pendingAjaxCount==0||$.active==0)unbindAjaxHandlers(),recordPendingAjaxComplete()}function onAjaxSend(a,b,c){c&&c.url&&(newAjaxRequests[c.url]||(newAjaxRequests[c.url]=[]),newAjaxRequests[c.url].push(c))}function recordPendingAjaxComplete(){recordMilestone("ajax_complete_time",(new Date).getTime())}function bindAjaxHandlers(){$(document).bind("ajaxComplete",onAjaxComplete),$(document).bind("ajaxSend",onAjaxSend)}function unbindAjaxHandlers(){$(document).unbind("ajaxComplete",onAjaxComplete),$(document).unbind("ajaxSend",onAjaxSend)}function startAjaxTracking(){startingAjaxCount=pendingAjaxCount=$.active,recordMilestone("ajax_count",startingAjaxCount),startingAjaxCount==0?recordPendingAjaxComplete():(unbindAjaxHandlers(),bindAjaxHandlers())}function recordMilestone(a,b){window.ttftData&&!window.ttftData[a]&&(window.ttftData[a]=b),scribeMilestones(!1)}var scribeTransport=require("app/data/scribe_transport"),recorded=!1,requiredMilestones=["page","client_record_time","aq_empty_time","ajax_complete_time","ajax_count"],startingAjaxCount=0,pendingAjaxCount=0,newAjaxRequests={};window.ttft={recordMilestone:recordMilestone},scribeMilestones(!1),setTimeout(function(){scribeMilestones(!0)},45e3),module.exports={startAjaxTracking:startAjaxTracking}
});